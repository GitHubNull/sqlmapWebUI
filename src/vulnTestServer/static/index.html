<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VulnShop - SQL注入测试靶场</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="logo">🛒</span>
            <span class="brand-name">VulnShop</span>
            <span class="badge danger">SQLi Lab</span>
        </div>
        <div class="nav-links">
            <a href="#" class="nav-link active" data-page="home">首页</a>
            <a href="#" class="nav-link" data-page="products">商品中心</a>
            <a href="#" class="nav-link" data-page="orders">订单管理</a>
            <a href="#" class="nav-link" data-page="profile">个人中心</a>
            <a href="#" class="nav-link" data-page="config">系统配置</a>
        </div>
        <div class="nav-right">
            <button class="theme-toggle" id="themeToggle" title="切换主题">
                <span class="theme-icon-light">☀️</span>
                <span class="theme-icon-dark">🌙</span>
            </button>
            <div class="cart-icon" id="cartToggle">
                🛒
                <span class="cart-count" id="cartCount">0</span>
            </div>
            <div class="nav-user">
                <span id="userStatus">未登录</span>
                <button id="loginBtn" class="btn btn-primary btn-sm">登录</button>
                <button id="logoutBtn" class="btn btn-secondary btn-sm" style="display:none;">退出</button>
            </div>
        </div>
    </nav>

    <!-- 警告横幅 -->
    <div class="warning-banner">
        ⚠️ 此系统包含故意设置的SQL注入漏洞，仅供安全测试和教育目的使用！禁止用于非法用途！
    </div>

    <!-- 主容器 -->
    <div class="main-container">
        <!-- 侧边栏 -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">漏洞接口</div>
                <ul class="sidebar-menu">
                    <li><a href="#" data-api="login"><span class="icon">🔓</span> 登录接口 (Error)</a></li>
                    <li><a href="#" data-api="profile"><span class="icon">👤</span> 用户资料 (Union)</a></li>
                    <li><a href="#" data-api="search"><span class="icon">🔍</span> 商品搜索 (Boolean)</a></li>
                    <li><a href="#" data-api="detail"><span class="icon">📦</span> 商品详情 (Time)</a></li>
                    <li><a href="#" data-api="order"><span class="icon">📋</span> 订单查询 (Stacked)</a></li>
                    <li><a href="#" data-api="register"><span class="icon">📝</span> 用户注册 (2nd Order)</a></li>
                    <li><a href="#" data-api="checkout"><span class="icon">💳</span> 结算下单 (Error)</a></li>
                    <li><a href="#" data-api="cart"><span class="icon">🛒</span> 购物车 (Union)</a></li>
                </ul>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-title">快捷操作</div>
                <ul class="sidebar-menu">
                    <li><a href="#" id="resetDbLink"><span class="icon">🔄</span> 重置数据库</a></li>
                    <li><a href="#" id="viewLogsLink"><span class="icon">📊</span> 查看日志</a></li>
                </ul>
            </div>
        </aside>

        <!-- 内容区域 -->
        <main class="content">
            <!-- ==================== 首页 ==================== -->
            <section id="page-home" class="page active">
                <!-- Hero Banner -->
                <div class="hero-banner">
                    <div class="hero-content">
                        <div class="hero-text">
                            <h1 class="hero-title">SQL注入测试靶场</h1>
                            <p class="hero-subtitle">VulnShop - 模拟真实电商环境的安全测试平台</p>
                            <p class="hero-desc">包含8种常见SQL注入漏洞类型，支持3种难度级别，完善的购物流程模拟，适用于渗透测试工具开发与安全研究</p>
                            <div class="hero-actions">
                                <button class="btn btn-primary btn-lg" data-page="products" onclick="ui.showPage('products')">🛍️ 浏览商品</button>
                                <button class="btn btn-outline btn-lg" onclick="ui.showModal('loginModal')">🔐 开始测试</button>
                            </div>
                        </div>
                        <div class="hero-stats-grid">
                            <div class="hero-stat-card">
                                <div class="stat-icon">🔓</div>
                                <div class="stat-value">8</div>
                                <div class="stat-label">漏洞接口</div>
                            </div>
                            <div class="hero-stat-card">
                                <div class="stat-icon">📦</div>
                                <div class="stat-value" id="productCount">10</div>
                                <div class="stat-label">商品数量</div>
                            </div>
                            <div class="hero-stat-card">
                                <div class="stat-icon">📋</div>
                                <div class="stat-value" id="orderCount">5</div>
                                <div class="stat-label">历史订单</div>
                            </div>
                            <div class="hero-stat-card">
                                <div class="stat-icon">⚙️</div>
                                <div class="stat-value">3</div>
                                <div class="stat-label">难度级别</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 快速入门区域 -->
                <div class="quick-start-section">
                    <div class="section-header">
                        <h2>🚀 快速开始</h2>
                        <p>选择一个漏洞类型开始你的安全测试之旅</p>
                    </div>
                    <div class="vuln-cards-grid">
                        <div class="vuln-card" data-api="login">
                            <div class="vuln-card-icon error">🔓</div>
                            <div class="vuln-card-content">
                                <h3>登录接口</h3>
                                <span class="vuln-tag error">Error-based</span>
                                <p>POST /api/user/login</p>
                                <code>admin' AND 1=1--</code>
                            </div>
                        </div>
                        <div class="vuln-card" data-api="profile">
                            <div class="vuln-card-icon union">👤</div>
                            <div class="vuln-card-content">
                                <h3>用户资料</h3>
                                <span class="vuln-tag union">Union-based</span>
                                <p>GET /api/user/profile</p>
                                <code>1 UNION SELECT 1,2,3--</code>
                            </div>
                        </div>
                        <div class="vuln-card" data-api="search">
                            <div class="vuln-card-icon boolean">🔍</div>
                            <div class="vuln-card-content">
                                <h3>商品搜索</h3>
                                <span class="vuln-tag boolean">Boolean Blind</span>
                                <p>GET /api/products/search</p>
                                <code>test' AND 1=1--</code>
                            </div>
                        </div>
                        <div class="vuln-card" data-api="detail">
                            <div class="vuln-card-icon time">📦</div>
                            <div class="vuln-card-content">
                                <h3>商品详情</h3>
                                <span class="vuln-tag time">Time-based</span>
                                <p>GET /api/products/detail</p>
                                <code>1 AND randomblob(1e8)</code>
                            </div>
                        </div>
                        <div class="vuln-card" data-api="order">
                            <div class="vuln-card-icon stacked">📋</div>
                            <div class="vuln-card-content">
                                <h3>订单查询</h3>
                                <span class="vuln-tag stacked">Stacked Queries</span>
                                <p>GET /api/orders/query</p>
                                <code>'; INSERT INTO...--</code>
                            </div>
                        </div>
                        <div class="vuln-card" data-api="register">
                            <div class="vuln-card-icon second">📝</div>
                            <div class="vuln-card-content">
                                <h3>用户注册</h3>
                                <span class="vuln-tag second">2nd Order</span>
                                <p>POST /api/user/register</p>
                                <code>admin'--</code>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 底部信息区域 -->
                <div class="home-info-grid">
                    <!-- 测试账户 -->
                    <div class="panel">
                        <div class="panel-header">
                            <span class="panel-title">👥 测试账户</span>
                        </div>
                        <div class="panel-body">
                            <div class="account-list">
                                <div class="account-item">
                                    <div class="account-info">
                                        <div class="account-avatar">A</div>
                                        <div>
                                            <div class="account-name">admin</div>
                                            <div class="account-role">管理员</div>
                                        </div>
                                    </div>
                                    <div class="account-cred">
                                        <code>admin123</code>
                                        <button class="btn btn-sm btn-outline copy-btn" onclick="cart.copyText('admin / admin123')">复制</button>
                                    </div>
                                </div>
                                <div class="account-item">
                                    <div class="account-info">
                                        <div class="account-avatar" style="background:#3498db">T</div>
                                        <div>
                                            <div class="account-name">test</div>
                                            <div class="account-role">普通用户</div>
                                        </div>
                                    </div>
                                    <div class="account-cred">
                                        <code>test</code>
                                        <button class="btn btn-sm btn-outline copy-btn" onclick="cart.copyText('test / test')">复制</button>
                                    </div>
                                </div>
                                <div class="account-item">
                                    <div class="account-info">
                                        <div class="account-avatar" style="background:#9b59b6">A</div>
                                        <div>
                                            <div class="account-name">alice</div>
                                            <div class="account-role">普通用户</div>
                                        </div>
                                    </div>
                                    <div class="account-cred">
                                        <code>alice123</code>
                                        <button class="btn btn-sm btn-outline copy-btn" onclick="cart.copyText('alice / alice123')">复制</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 系统状态 -->
                    <div class="panel">
                        <div class="panel-header">
                            <span class="panel-title">📊 系统状态</span>
                        </div>
                        <div class="panel-body">
                            <div class="status-grid">
                                <div class="status-item">
                                    <span class="status-label">版本</span>
                                    <span class="status-value" id="sysVersion">1.0.0</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">难度</span>
                                    <span class="status-value easy" id="sysDifficulty">EASY</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">数据库</span>
                                    <span class="status-value">SQLite3</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">调试模式</span>
                                    <span class="status-value" id="sysDebug">开启</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 热门商品 -->
                    <div class="panel">
                        <div class="panel-header">
                            <span class="panel-title">🔥 热门商品</span>
                            <a href="#" class="panel-link" onclick="ui.showPage('products');return false;">查看全部 →</a>
                        </div>
                        <div class="panel-body">
                            <div id="hotProducts" class="hot-products-list">
                                <!-- 动态加载 -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ==================== 商品页面 ==================== -->
            <section id="page-products" class="page">
                <div class="products-container">
                    <!-- 左侧筛选栏 -->
                    <aside class="products-filter">
                        <div class="filter-section">
                            <h3>🏷️ 商品分类</h3>
                            <div class="filter-options">
                                <label class="filter-option active" data-category="">
                                    <input type="radio" name="category" value="" checked>
                                    <span>全部商品</span>
                                </label>
                                <label class="filter-option" data-category="electronics">
                                    <input type="radio" name="category" value="electronics">
                                    <span>📱 电子产品</span>
                                </label>
                                <label class="filter-option" data-category="fashion">
                                    <input type="radio" name="category" value="fashion">
                                    <span>👔 服装配饰</span>
                                </label>
                                <label class="filter-option" data-category="books">
                                    <input type="radio" name="category" value="books">
                                    <span>📚 图书音像</span>
                                </label>
                                <label class="filter-option" data-category="home">
                                    <input type="radio" name="category" value="home">
                                    <span>🏠 家居家装</span>
                                </label>
                            </div>
                        </div>
                        <div class="filter-section">
                            <h3>💡 漏洞提示</h3>
                            <div class="vuln-hint">
                                <strong>商品搜索:</strong> Boolean-based盲注
                                <code>test' AND (SELECT SUBSTR(username,1,1) FROM users WHERE is_admin=1)='a'--</code>
                            </div>
                        </div>
                    </aside>
                    
                    <!-- 右侧商品列表 -->
                    <div class="products-main">
                        <div class="products-header">
                            <h2>🛍️ 商品中心</h2>
                            <div class="search-bar">
                                <input type="text" id="searchKeyword" placeholder="搜索商品名称...">
                                <button class="btn btn-primary" id="searchBtn">🔍 搜索</button>
                            </div>
                        </div>
                        <div id="productList" class="product-grid"></div>
                    </div>
                </div>
            </section>

            <!-- ==================== 订单页面 ==================== -->
            <section id="page-orders" class="page">
                <div class="page-header">
                    <h2>订单管理</h2>
                </div>
                <div class="orders-layout">
                    <div class="order-form-section">
                        <div class="panel">
                            <div class="panel-header">
                                <span class="panel-title">订单查询</span>
                                <span class="vuln-tag stacked">Stacked Queries</span>
                            </div>
                            <div class="panel-body">
                                <div class="vuln-hint">
                                    <strong>💡 漏洞提示:</strong> 订单查询接口存在堆叠查询注入漏洞
                                    <code>ORD20231201001'; INSERT INTO users(username,password,email) VALUES('hacker','pwned','h@h.com');--</code>
                                </div>
                                <div class="form-group">
                                    <label>订单号</label>
                                    <input type="text" id="orderNo" placeholder="输入订单号查询">
                                </div>
                                <div class="form-group">
                                    <label>或按用户ID查询</label>
                                    <input type="text" id="orderUserId" placeholder="输入用户ID">
                                </div>
                                <button class="btn btn-primary" id="queryOrderBtn">查询订单</button>
                                <div id="orderQueryResult" style="margin-top:20px;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="order-history">
                        <div class="panel">
                            <div class="panel-header">
                                <span class="panel-title">历史订单</span>
                            </div>
                            <div class="panel-body" id="orderHistoryList">
                                <!-- 动态加载 -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ==================== 个人中心 ==================== -->
            <section id="page-profile" class="page">
                <div class="page-header">
                    <h2>个人中心</h2>
                </div>
                <div class="panel" style="margin-bottom:20px;">
                    <div class="panel-header">
                        <span class="panel-title">查询用户资料</span>
                        <span class="vuln-tag union">Union-based</span>
                    </div>
                    <div class="panel-body">
                        <div class="vuln-hint">
                            <strong>💡 漏洞提示:</strong> 用户资料接口存在联合查询注入
                            <code>1 UNION SELECT 1,flag,description,4,5,6 FROM secrets--</code>
                        </div>
                        <div style="display:flex;gap:15px;align-items:flex-end;">
                            <div class="form-group" style="flex:1;margin-bottom:0;">
                                <label>用户ID</label>
                                <input type="text" id="profileUserId" placeholder="输入用户ID" value="1">
                            </div>
                            <button class="btn btn-primary" id="queryProfileBtn">查询资料</button>
                        </div>
                    </div>
                </div>
                <div id="profileResult">
                    <div class="profile-layout">
                        <div class="profile-card">
                            <div class="profile-avatar" id="profileAvatar">?</div>
                            <div class="profile-name" id="profileName">-</div>
                            <div class="profile-email" id="profileEmail">-</div>
                            <div class="profile-balance" id="profileBalance">¥0.00</div>
                        </div>
                        <div class="panel">
                            <div class="panel-header">
                                <span class="panel-title">详细信息</span>
                            </div>
                            <div class="panel-body">
                                <div class="info-row"><span class="info-label">用户ID</span><span class="info-value" id="infoId">-</span></div>
                                <div class="info-row"><span class="info-label">手机号</span><span class="info-value" id="infoPhone">-</span></div>
                                <div class="info-row"><span class="info-label">地址</span><span class="info-value" id="infoAddress">-</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ==================== 配置页面 ==================== -->
            <section id="page-config" class="page">
                <div class="page-header">
                    <h2>系统配置</h2>
                </div>
                <div class="config-grid">
                    <div class="config-card">
                        <h3>难度设置</h3>
                        <p style="color:#888;font-size:13px;margin-bottom:15px;">调整WAF防护级别</p>
                        <div class="difficulty-options">
                            <label class="difficulty-option" data-value="easy">
                                <input type="radio" name="difficulty" value="easy">
                                <div><div class="difficulty-name" style="color:#2ecc71">Easy</div><div class="difficulty-desc">无任何防护，所有注入类型可用</div></div>
                            </label>
                            <label class="difficulty-option" data-value="medium">
                                <input type="radio" name="difficulty" value="medium">
                                <div><div class="difficulty-name" style="color:#f1c40f">Medium</div><div class="difficulty-desc">简单WAF，可通过大小写/编码绕过</div></div>
                            </label>
                            <label class="difficulty-option" data-value="hard">
                                <input type="radio" name="difficulty" value="hard">
                                <div><div class="difficulty-name" style="color:#e74c3c">Hard</div><div class="difficulty-desc">严格WAF，需要高级绕过技术</div></div>
                            </label>
                        </div>
                        <button class="btn btn-primary" id="saveDifficultyBtn" style="margin-top:15px;">保存设置</button>
                    </div>
                    <div class="config-card">
                        <h3>数据库管理</h3>
                        <p style="color:#888;font-size:13px;margin-bottom:15px;">重置数据库到初始状态</p>
                        <button class="btn btn-danger" id="resetDbBtn">🔄 重置数据库</button>
                        <p style="color:#666;font-size:12px;margin-top:15px;">这将清除所有注入产生的数据，恢复测试账户和商品数据。</p>
                    </div>
                </div>
            </section>

            <footer class="footer">
                VulnShop v1.0.0 | SQL Injection Test Lab | 仅供安全测试和教育目的使用
            </footer>
        </main>
    </div>

    <!-- 购物车面板 -->
    <div class="overlay" id="cartOverlay"></div>
    <div class="cart-panel" id="cartPanel">
        <div class="cart-header">
            <h3>🛒 购物车</h3>
            <button class="cart-close" id="cartClose">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="cart-empty">
                <div class="icon">🛒</div>
                <p>购物车是空的</p>
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span class="cart-total-label">合计</span>
                <span class="cart-total-value" id="cartTotal">¥0.00</span>
            </div>
            <button class="btn btn-primary btn-block" id="checkoutBtn">💳 结算下单</button>
            <div class="cart-hint">
                <strong>💡 漏洞提示:</strong> 结算接口存在Error-based SQL注入
            </div>
        </div>
    </div>

    <!-- 登录弹窗 -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>用户登录</h3>
                <button class="cart-close" onclick="ui.hideModal('loginModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="vuln-hint">
                    <strong>💡 漏洞提示:</strong> 登录接口存在Error-based SQL注入
                    <code>admin' AND 1=1--</code>
                </div>
                <form id="loginForm">
                    <div class="form-group">
                        <label>用户名</label>
                        <input type="text" id="loginUsername" placeholder="输入用户名">
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="loginPassword" placeholder="输入密码">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">登录</button>
                </form>
                <div id="loginResult" class="result-message" style="display:none;"></div>
            </div>
            <div class="modal-footer">
                没有账户？<a href="#" id="showRegisterLink">注册新账户</a>
            </div>
        </div>
    </div>

    <!-- 注册弹窗 -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>用户注册</h3>
                <button class="cart-close" onclick="ui.hideModal('registerModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="vuln-hint">
                    <strong>💡 漏洞提示:</strong> 注册接口存在二次注入漏洞
                    <code>注册用户名: admin'--</code>
                </div>
                <form id="registerForm">
                    <div class="form-group">
                        <label>用户名</label>
                        <input type="text" id="regUsername" placeholder="输入用户名">
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="regPassword" placeholder="输入密码">
                    </div>
                    <div class="form-group">
                        <label>邮箱</label>
                        <input type="email" id="regEmail" placeholder="输入邮箱">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">注册</button>
                </form>
                <div id="registerResult" class="result-message" style="display:none;"></div>
            </div>
        </div>
    </div>

    <!-- 商品详情弹窗 -->
    <div id="productModal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3>📦 商品详情</h3>
                <button class="cart-close" onclick="ui.hideModal('productModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="vuln-hint">
                    <strong>💡 漏洞提示:</strong> 商品详情接口存在Time-based盲注
                    <code>1 AND (SELECT CASE WHEN (1=1) THEN randomblob(100000000) ELSE 1 END)</code>
                </div>
                <div id="productDetail" class="product-detail-layout">
                    <!-- 动态加载 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 结算弹窗 -->
    <div id="checkoutModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>订单结算</h3>
                <button class="cart-close" onclick="ui.hideModal('checkoutModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="vuln-hint">
                    <strong>💡 漏洞提示:</strong> 结算接口存在Error-based SQL注入
                    <code>在地址字段输入: test' AND 1=CAST((SELECT flag FROM secrets LIMIT 1) AS int)--</code>
                </div>
                <form id="checkoutForm">
                    <div class="form-group">
                        <label>收货地址</label>
                        <textarea id="checkoutAddress" placeholder="输入收货地址 (存在SQL注入)"></textarea>
                    </div>
                    <div class="form-group">
                        <label>联系电话</label>
                        <input type="text" id="checkoutPhone" placeholder="输入联系电话">
                    </div>
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
                        <div>
                            <span style="color:#888;">订单金额：</span>
                            <span style="font-size:24px;color:#e94560;font-weight:700;" id="checkoutTotal">¥0.00</span>
                        </div>
                        <button type="submit" class="btn btn-success">确认下单</button>
                    </div>
                </form>
                <div id="checkoutResult" class="result-message" style="display:none;"></div>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
