# Headeré…ç½®åŠŸèƒ½å‰ç«¯å®ç°æ€»ç»“

## ğŸ“‹ å®ç°å†…å®¹

### 1. é…ç½®é¡µé¢æ”¹é€ ä¸ºTabå¸ƒå±€

å°†åŸæœ‰çš„å•é¡µé…ç½®æ”¹é€ ä¸ºä¸‰ä¸ªTabæ ‡ç­¾é¡µï¼š

#### Tab 1: ç³»ç»Ÿé…ç½®
- **åŠŸèƒ½**: åŸæœ‰çš„è‡ªåŠ¨åˆ·æ–°é—´éš”é…ç½®
- **å›¾æ ‡**: ğŸ”§ é½¿è½®å›¾æ ‡
- **å†…å®¹**: ä¿æŒåŸæœ‰çš„æ»‘å—é…ç½®åŠŸèƒ½

#### Tab 2: Headerè§„åˆ™ç®¡ç†  
- **åŠŸèƒ½**: æŒä¹…åŒ–è¯·æ±‚å¤´è§„åˆ™çš„CRUDç®¡ç†
- **å›¾æ ‡**: ğŸ“‹ åˆ—è¡¨å›¾æ ‡
- **ç‰¹æ€§**:
  - åˆ›å»º/ç¼–è¾‘/åˆ é™¤è§„åˆ™
  - æ”¯æŒä½œç”¨åŸŸé…ç½®(å¯é€‰)
  - ä¼˜å…ˆçº§è®¾ç½®(0-100)
  - æ›¿æ¢ç­–ç•¥é€‰æ‹©
  - å¯ç”¨/ç¦ç”¨çŠ¶æ€åˆ‡æ¢

#### Tab 3: ä¼šè¯Headerç®¡ç†
- **åŠŸèƒ½**: ä¼šè¯çº§è¯·æ±‚å¤´ç®¡ç†
- **å›¾æ ‡**: â° æ—¶é’Ÿå›¾æ ‡
- **ç‰¹æ€§**:
  - æ‰¹é‡æ·»åŠ Session Headers
  - è®¾ç½®ä¼˜å…ˆçº§å’ŒTTL(ç”Ÿå­˜æ—¶é—´)
  - æŸ¥çœ‹è¿‡æœŸæ—¶é—´
  - ä¸€é”®æ¸…é™¤æ‰€æœ‰

---

## ğŸ¨ UIè®¾è®¡ç‰¹ç‚¹

### 1. Tabå¯¼èˆªç¾åŒ–
- æ¸å˜èƒŒæ™¯æ•ˆæœ
- HoveråŠ¨ç”»æ•ˆæœ
- å›¾æ ‡+æ–‡å­—ç»„åˆ
- æ¿€æ´»çŠ¶æ€é«˜äº®

### 2. æ•°æ®è¡¨æ ¼
- æ¡çº¹è¡Œæ˜¾ç¤º
- åˆ†é¡µåŠŸèƒ½
- æ’åºåŠŸèƒ½
- ä¼˜å…ˆçº§Tagç€è‰²

### 3. å¯¹è¯æ¡†è¡¨å•
- æ¸…æ™°çš„å­—æ®µåˆ†ç»„
- ä½œç”¨åŸŸé…ç½®å¯æŠ˜å 
- å®æ—¶éªŒè¯æç¤º
- åŠ è½½çŠ¶æ€æŒ‡ç¤º

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/frontEnd/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ headerRule.ts                    # âœ… æ–°å¢: Headerè§„åˆ™API
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ headerRule.ts                    # âœ… æ›´æ–°: ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ views/
â”‚       â””â”€â”€ Config/
â”‚           â”œâ”€â”€ index.vue                    # âœ… æ›´æ–°: Tabå¸ƒå±€ä¸»é¡µ
â”‚           â””â”€â”€ components/
â”‚               â”œâ”€â”€ HeaderRulesConfig.vue    # âœ… æ–°å¢: æŒä¹…åŒ–è§„åˆ™ç»„ä»¶
â”‚               â””â”€â”€ SessionHeadersConfig.vue # âœ… æ–°å¢: ä¼šè¯Headerç»„ä»¶
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. ç±»å‹å®šä¹‰ (`types/headerRule.ts`)

```typescript
// ä½œç”¨åŸŸé…ç½®
export interface HeaderScope {
  protocol_pattern?: string
  host_pattern?: string
  ip_pattern?: string
  port_pattern?: string
  path_pattern?: string
  use_regex?: boolean
}

// æŒä¹…åŒ–è§„åˆ™
export interface PersistentHeaderRule {
  id: number
  name: string
  header_name: string
  header_value: string
  replace_strategy: ReplaceStrategy
  match_condition?: string
  priority: number
  is_active: boolean
  scope?: HeaderScope | null
  created_at?: string
  updated_at?: string
}

// ä¼šè¯Header
export interface SessionHeader {
  header_name: string
  header_value: string
  priority?: number
  ttl?: number
}
```

### 2. APIæ¥å£ (`api/headerRule.ts`)

#### æŒä¹…åŒ–è§„åˆ™API
- `getPersistentRules()` - è·å–è§„åˆ™åˆ—è¡¨
- `getPersistentRuleById()` - è·å–å•ä¸ªè§„åˆ™
- `createPersistentRule()` - åˆ›å»ºè§„åˆ™
- `updatePersistentRule()` - æ›´æ–°è§„åˆ™
- `deletePersistentRule()` - åˆ é™¤è§„åˆ™

#### ä¼šè¯HeaderAPI
- `getSessionHeaders()` - è·å–ä¼šè¯Headers
- `setSessionHeaders()` - è®¾ç½®ä¼šè¯Headers
- `clearSessionHeaders()` - æ¸…é™¤ä¼šè¯Headers

#### å…¶ä»–åŠŸèƒ½
- `previewHeaderProcessing()` - é¢„è§ˆå¤„ç†ç»“æœ
- `getHeaderManagementStats()` - è·å–ç»Ÿè®¡ä¿¡æ¯

---

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### Headerè§„åˆ™ç®¡ç†

#### 1. è§„åˆ™åˆ—è¡¨
- âœ… è¡¨æ ¼å±•ç¤ºæ‰€æœ‰è§„åˆ™
- âœ… æŒ‰ä¼˜å…ˆçº§/IDæ’åº
- âœ… çŠ¶æ€Tagæ ‡è¯†(å¯ç”¨/ç¦ç”¨)
- âœ… ä½œç”¨åŸŸTagæ ‡è¯†(å…¨å±€/æœ‰ä½œç”¨åŸŸ)
- âœ… åˆ†é¡µæ˜¾ç¤º(5/10/20/50æ¡)

#### 2. åˆ›å»ºè§„åˆ™
- âœ… å¿…å¡«å­—æ®µ: è§„åˆ™åç§°ã€Headeråç§°ã€Headerå€¼
- âœ… å¯é€‰å­—æ®µ: æ›¿æ¢ç­–ç•¥ã€ä¼˜å…ˆçº§ã€åŒ¹é…æ¡ä»¶
- âœ… ä½œç”¨åŸŸé…ç½®(å¯é€‰):
  - åè®®åŒ¹é… (http/https)
  - ä¸»æœºååŒ¹é… (æ”¯æŒé€šé…ç¬¦)
  - è·¯å¾„åŒ¹é… (æ”¯æŒé€šé…ç¬¦)
  - æ­£åˆ™è¡¨è¾¾å¼å¼€å…³
- âœ… é»˜è®¤å¯ç”¨çŠ¶æ€

#### 3. ç¼–è¾‘è§„åˆ™
- âœ… åŠ è½½ç°æœ‰è§„åˆ™æ•°æ®
- âœ… æ”¯æŒä¿®æ”¹æ‰€æœ‰å­—æ®µ
- âœ… å®æ—¶éªŒè¯
- âœ… ä¿å­˜ååˆ·æ–°åˆ—è¡¨

#### 4. åˆ é™¤è§„åˆ™
- âœ… ç¡®è®¤å¯¹è¯æ¡†
- âœ… æˆåŠŸæç¤º
- âœ… è‡ªåŠ¨åˆ·æ–°åˆ—è¡¨

#### 5. å¿«æ·æ“ä½œ
- âœ… ä¸€é”®å¯ç”¨/ç¦ç”¨
- âœ… ç¼–è¾‘æŒ‰é’®
- âœ… åˆ é™¤æŒ‰é’®
- âœ… Tooltipæç¤º

### ä¼šè¯Headerç®¡ç†

#### 1. æ‰¹é‡æ·»åŠ 
- âœ… å¤šè¡Œæ–‡æœ¬è¾“å…¥
- âœ… è‡ªåŠ¨è§£ææ ¼å¼ (`Header-Name: Header-Value`)
- âœ… ç»Ÿä¸€è®¾ç½®ä¼˜å…ˆçº§
- âœ… ç»Ÿä¸€è®¾ç½®TTL(60-86400ç§’)

#### 2. åˆ—è¡¨å±•ç¤º
- âœ… Headeråç§°å’Œå€¼
- âœ… ä¼˜å…ˆçº§æ˜¾ç¤º
- âœ… è¿‡æœŸæ—¶é—´æ˜¾ç¤º
- âœ… åˆ›å»ºæ—¶é—´æ˜¾ç¤º

#### 3. æ¸…é™¤åŠŸèƒ½
- âœ… ä¸€é”®æ¸…é™¤æ‰€æœ‰Session Headers
- âœ… ç¡®è®¤å¯¹è¯æ¡†
- âœ… æˆåŠŸæç¤º

#### 4. æç¤ºä¿¡æ¯
- âœ… è“è‰²ä¿¡æ¯æ¨ªå¹…
- âœ… è¯´æ˜ä¼šè¯æœ‰æ•ˆæœŸ

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åˆ›å»ºå…¨å±€User-Agentè§„åˆ™

```json
{
  "name": "å…¨å±€User-Agent",
  "header_name": "User-Agent",
  "header_value": "Mozilla/5.0 SecurityScanner",
  "replace_strategy": "REPLACE",
  "priority": 50,
  "is_active": true,
  "scope": null  // å…¨å±€ç”Ÿæ•ˆ
}
```

### ç¤ºä¾‹2: åˆ›å»ºAPIè®¤è¯è§„åˆ™(å¸¦ä½œç”¨åŸŸ)

```json
{
  "name": "ç”Ÿäº§ç¯å¢ƒAPIè®¤è¯",
  "header_name": "Authorization",
  "header_value": "Bearer prod-token-xxx",
  "replace_strategy": "REPLACE",
  "priority": 80,
  "is_active": true,
  "scope": {
    "protocol_pattern": "https",
    "host_pattern": "api.production.com",
    "path_pattern": "/v1/*",
    "use_regex": false
  }
}
```

### ç¤ºä¾‹3: æ‰¹é‡æ·»åŠ Session Headers

```
Authorization: Bearer session-token-123
X-Request-ID: req-456
X-Custom-Header: custom-value
```

è®¾ç½®:
- ä¼˜å…ˆçº§: 50
- TTL: 3600ç§’(1å°æ—¶)

---

## ğŸ¨ æ ·å¼è®¾è®¡

### 1. Tabå¯¼èˆªæ ·å¼
- æ¸å˜èƒŒæ™¯
- åœ†è§’è®¾è®¡
- HoveråŠ¨ç”»
- æ¿€æ´»çŠ¶æ€é«˜äº®
- å›¾æ ‡åŠ¨ç”»æ•ˆæœ

### 2. æ•°æ®è¡¨æ ¼æ ·å¼
- æ¡çº¹è¡Œ(stripedRows)
- åˆ†é¡µæ§ä»¶
- æ’åºç®­å¤´
- Tagæ ‡ç­¾ç€è‰²
- æŒ‰é’®Tooltip

### 3. å¯¹è¯æ¡†æ ·å¼
- æ¸…æ™°çš„å­—æ®µåˆ†ç»„
- ä½œç”¨åŸŸé…ç½®åŒºåŸŸé«˜äº®
- å¸®åŠ©æ–‡æœ¬æ ·å¼
- å“åº”å¼å®½åº¦(600px)

### 4. å“åº”å¼è®¾è®¡
- é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- è¡¨æ ¼è‡ªé€‚åº”
- å¯¹è¯æ¡†å±…ä¸­æ˜¾ç¤º

---

## ğŸ” æ•°æ®æµç¨‹

### åˆ›å»ºè§„åˆ™æµç¨‹
```
ç”¨æˆ·å¡«å†™è¡¨å•
    â†“
éªŒè¯å¿…å¡«å­—æ®µ
    â†“
å¤„ç†ä½œç”¨åŸŸé…ç½®(å¯é€‰)
    â†“
è°ƒç”¨createPersistentRule API
    â†“
åç«¯ä¿å­˜åˆ°æ•°æ®åº“
    â†“
è¿”å›æˆåŠŸå“åº”
    â†“
åˆ·æ–°è§„åˆ™åˆ—è¡¨
    â†“
æ˜¾ç¤ºæˆåŠŸæç¤º
```

### ä¼šè¯Headeræµç¨‹
```
ç”¨æˆ·è¾“å…¥å¤šè¡ŒHeaders
    â†“
è§£æHeader-Name: Header-Value
    â†“
è®¾ç½®ä¼˜å…ˆçº§å’ŒTTL
    â†“
è°ƒç”¨setSessionHeaders API
    â†“
åç«¯å­˜å‚¨åˆ°ä¼šè¯ç®¡ç†å™¨
    â†“
è¿”å›æˆåŠŸå“åº”
    â†“
åˆ·æ–°Session Headersåˆ—è¡¨
    â†“
æ˜¾ç¤ºæˆåŠŸæç¤º
```

---

## âœ… éªŒè¯æ¸…å•

### åŠŸèƒ½éªŒè¯
- [ ] Tabåˆ‡æ¢æ­£å¸¸å·¥ä½œ
- [ ] æŒä¹…åŒ–è§„åˆ™CRUDåŠŸèƒ½æ­£å¸¸
- [ ] ä½œç”¨åŸŸé…ç½®å¯é€‰å¡«å†™
- [ ] ä¼šè¯Headeræ‰¹é‡æ·»åŠ æ­£å¸¸
- [ ] å¯ç”¨/ç¦ç”¨çŠ¶æ€åˆ‡æ¢æ­£å¸¸
- [ ] åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†æ­£å¸¸
- [ ] Toastæç¤ºæ­£å¸¸æ˜¾ç¤º

### UIéªŒè¯
- [ ] Tabå¯¼èˆªæ ·å¼æ­£ç¡®
- [ ] æ•°æ®è¡¨æ ¼æ˜¾ç¤ºæ­£ç¡®
- [ ] å¯¹è¯æ¡†å¸ƒå±€æ­£ç¡®
- [ ] å“åº”å¼å¸ƒå±€æ­£å¸¸
- [ ] æš—é»‘æ¨¡å¼å…¼å®¹

### æ•°æ®éªŒè¯
- [ ] è¡¨å•éªŒè¯æ­£ç¡®
- [ ] APIè°ƒç”¨æˆåŠŸ
- [ ] é”™è¯¯å¤„ç†æ­£ç¡®
- [ ] æ•°æ®åˆ·æ–°æ­£å¸¸

---

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

### åŠŸèƒ½ä¼˜åŒ–
1. æ·»åŠ è§„åˆ™å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½
2. æ·»åŠ è§„åˆ™æ‰¹é‡æ“ä½œ
3. æ·»åŠ è§„åˆ™æœç´¢è¿‡æ»¤
4. æ·»åŠ è§„åˆ™æµ‹è¯•åŠŸèƒ½
5. æ·»åŠ è§„åˆ™ç»Ÿè®¡å›¾è¡¨

### UIä¼˜åŒ–
1. æ·»åŠ åŠ è½½éª¨æ¶å±
2. ä¼˜åŒ–ç§»åŠ¨ç«¯æ˜¾ç¤º
3. æ·»åŠ åŠ¨ç”»è¿‡æ¸¡æ•ˆæœ
4. ä¼˜åŒ–è¡¨æ ¼æ€§èƒ½(è™šæ‹Ÿæ»šåŠ¨)

### ä½“éªŒä¼˜åŒ–
1. æ·»åŠ æ“ä½œæ’¤é”€åŠŸèƒ½
2. æ·»åŠ å¿«æ·é”®æ”¯æŒ
3. æ·»åŠ æ‰¹é‡ç¼–è¾‘æ¨¡å¼
4. ä¼˜åŒ–é”™è¯¯æç¤ºä¿¡æ¯

---

## ğŸ“ æ€»ç»“

æœ¬æ¬¡å®ç°å°†é…ç½®é¡µé¢æˆåŠŸæ”¹é€ ä¸ºTabå¸ƒå±€ï¼Œæ–°å¢äº†Headerè§„åˆ™ç®¡ç†å’Œä¼šè¯Headerç®¡ç†ä¸¤ä¸ªåŠŸèƒ½æ¨¡å—ï¼Œä¸åç«¯APIå®Œç¾å¯¹æ¥ã€‚UIè®¾è®¡ç¾è§‚ï¼ŒåŠŸèƒ½å®Œæ•´ï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½ã€‚

**å®ç°æ—¶é—´**: 2025-10-26  
**çŠ¶æ€**: âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: å¾…éªŒè¯
