# 功能组件

<cite>
**本文档引用的文件**   
- [TaskSummary.vue](file://src/frontEnd/src/components/TaskSummary.vue)
- [TaskFilter.vue](file://src/frontEnd/src/components/TaskFilter.vue)
- [HttpCodeEditor.vue](file://src/frontEnd/src/components/HttpCodeEditor.vue)
- [DefaultConfigPanel.vue](file://src/frontEnd/src/views/Config/components/DefaultConfigPanel.vue)
- [PresetConfigPanel.vue](file://src/frontEnd/src/views/Config/components/PresetConfigPanel.vue)
- [TaskBasicInfo.vue](file://src/frontEnd/src/views/TaskDetail/components/TaskBasicInfo.vue)
- [TaskLogs.vue](file://src/frontEnd/src/views/TaskDetail/components/TaskLogs.vue)
- [task.ts](file://src/frontEnd/src/types/task.ts)
- [task.ts](file://src/frontEnd/src/stores/task.ts)
</cite>

## 目录
1. [任务概览组件 (TaskSummary)](#任务概览组件-tasksummary)
2. [任务过滤组件 (TaskFilter)](#任务过滤组件-taskfilter)
3. [HTTP代码编辑器组件 (HttpCodeEditor)](#http代码编辑器组件-httpcodeeditor)
4. [配置管理面板组件](#配置管理面板组件)
5. [任务详情嵌套组件](#任务详情嵌套组件)
6. [组件通信与接口设计](#组件通信与接口设计)

## 任务概览组件 (TaskSummary)

`TaskSummary` 组件用于展示任务的汇总统计信息，通过直观的视觉设计呈现任务状态和SQL注入检测结果。该组件接收一个 `stats` 属性，类型为 `TaskStats`，包含总任务数、各状态任务数以及注入状态统计等数据。

组件采用网格布局，将统计信息分为三个主要部分：总任务数、任务状态统计和SQL注入统计。每个统计项都包含一个图标、标签和数值，通过不同的颜色和图标来区分不同的状态。例如，运行中任务使用蓝色，已完成任务使用绿色，失败任务使用红色。

组件的样式设计注重美观和用户体验，使用了渐变背景、阴影效果和悬停动画。在响应式设计方面，组件在移动设备上会自动调整布局，将多列显示改为单列显示，确保在不同设备上都有良好的显示效果。

**Section sources**
- [TaskSummary.vue](file://src/frontEnd/src/components/TaskSummary.vue)
- [task.ts](file://src/frontEnd/src/types/task.ts)

## 任务过滤组件 (TaskFilter)

`TaskFilter` 组件提供了多条件过滤功能，允许用户根据多种条件筛选任务列表。组件包含两个主要行：第一行用于关键字搜索，第二行用于筛选条件。

在关键字搜索部分，用户可以输入URL关键字和报文关键字进行搜索。在筛选条件部分，用户可以选择任务状态、注入状态，并设置创建时间和执行时间的范围。组件还提供了重置和刷新按钮，方便用户快速操作。

组件实现了防抖功能，避免在用户输入时频繁触发过滤操作。当用户输入搜索关键词时，组件会设置一个300ms的定时器，只有在用户停止输入后才会触发过滤操作。此外，组件还提供了过滤结果提示，显示当前过滤条件下的任务数量。

**Section sources**
- [TaskFilter.vue](file://src/frontEnd/src/components/TaskFilter.vue)
- [task.ts](file://src/frontEnd/src/types/task.ts)

## HTTP代码编辑器组件 (HttpCodeEditor)

`HttpCodeEditor` 组件基于 CodeMirror 6 实现，提供了代码高亮和格式化编辑功能。组件支持HTTP协议的语法高亮，能够识别请求行、Header名称、URL路径、HTTP版本等语法元素，并使用不同的颜色进行标记。

组件提供了搜索功能，支持正则表达式、大小写敏感和反转匹配等选项。用户可以通过快捷键（Ctrl+F）打开搜索工具栏，输入搜索关键词后，组件会高亮显示匹配的内容。此外，组件还提供了复制全部和清空内容的快捷操作。

组件支持主题切换，根据用户的主题设置自动应用浅色或暗色主题。在暗色主题下，组件使用深色背景和亮色文字，减少夜间使用时的视觉疲劳。组件还实现了样式隔离，确保其样式不会影响到其他组件。

**Section sources**
- [HttpCodeEditor.vue](file://src/frontEnd/src/components/HttpCodeEditor.vue)

## 配置管理面板组件

配置管理面板组件包括 `DefaultConfigPanel` 和 `PresetConfigPanel`，用于管理扫描配置。

`DefaultConfigPanel` 组件提供了扫描参数的配置界面，包括Level、Risk、DBMS、Technique等参数。用户可以通过输入框、下拉框和复选框等方式设置参数。组件还提供了命令行参数预览功能，实时显示当前配置对应的命令行参数。

`PresetConfigPanel` 组件用于管理常用配置，支持配置的增删改查操作。用户可以通过表格查看所有配置，并进行搜索、排序和过滤。组件还提供了导入和导出功能，方便用户在不同环境间共享配置。

**Section sources**
- [DefaultConfigPanel.vue](file://src/frontEnd/src/views/Config/components/DefaultConfigPanel.vue)
- [PresetConfigPanel.vue](file://src/frontEnd/src/views/Config/components/PresetConfigPanel.vue)

## 任务详情嵌套组件

任务详情页包含多个嵌套组件，用于分层展示任务的详细信息。

`TaskBasicInfo` 组件展示了任务的基本信息，包括任务ID、引擎ID、任务状态、注入状态、扫描URL、目标主机、创建时间、更新时间和来源IP。组件使用网格布局，将信息分为多个卡片，每个卡片包含一个标签和对应的值。

`TaskLogs` 组件用于展示任务的日志信息。组件提供了搜索和过滤功能，用户可以根据日志级别、时间范围和日志来源进行过滤。组件还支持高级搜索，用户可以使用正则表达式进行搜索。日志内容经过高亮处理，不同类型的日志使用不同的颜色显示。

**Section sources**
- [TaskBasicInfo.vue](file://src/frontEnd/src/views/TaskDetail/components/TaskBasicInfo.vue)
- [TaskLogs.vue](file://src/frontEnd/src/views/TaskDetail/components/TaskLogs.vue)

## 组件通信与接口设计

组件之间通过props和事件进行通信。父组件通过props向子组件传递数据，子组件通过emit事件向父组件发送消息。

例如，`TaskFilter` 组件通过 `update:filters` 事件向父组件传递过滤条件，父组件接收到事件后更新任务列表。`HttpCodeEditor` 组件通过 `update:modelValue` 事件向父组件传递编辑内容，实现双向绑定。

组件的props接口设计遵循单一职责原则，每个props都有明确的用途。例如，`TaskSummary` 组件的 `stats` props用于传递统计信息，`TaskFilter` 组件的 `filters` props用于传递过滤条件。

**Section sources**
- [TaskSummary.vue](file://src/frontEnd/src/components/TaskSummary.vue)
- [TaskFilter.vue](file://src/frontEnd/src/components/TaskFilter.vue)
- [HttpCodeEditor.vue](file://src/frontEnd/src/components/HttpCodeEditor.vue)
- [task.ts](file://src/frontEnd/src/types/task.ts)
- [task.ts](file://src/frontEnd/src/stores/task.ts)